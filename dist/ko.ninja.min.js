/*! ko.ninja - v0.0.1 - 2013-10-11
* Copyright (c) 2013 ; Licensed  */
!function(a,b){"function"==typeof define&&define.amd?define(["knockout","underscore"],b):"object"==typeof exports?module.exports=b(require("knockout"),require("underscore")):a.ko=b(a.ko,a._)}(this,function(a,b){var c=function(a,c){var d,e,f=this;return e=a&&b.has(a,"constructor")?a.constructor:function(){return f.apply(this,arguments)},b.extend(e,f,c),d=function(){this.constructor=e},d.prototype=f.prototype,e.prototype=new d,a&&b.extend(e.prototype,a),e.__super__=f.prototype,a.name&&(e.prototype.toString=function(){return a.name}),e},d={on:function(a,b,c){if(!f(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,c,d){if(!f(this,"once",a,[c,d])||!c)return this;var e=this,g=b.once(function(){e.off(a,g),c.apply(this,arguments)});return g._callback=c,this.on(a,g,d)},off:function(a,c,d){var e,g,h,i,j,k,l,m;if(!this._events||!f(this,"off",a,[c,d]))return this;if(!a&&!c&&!d)return this._events={},this;for(i=a?[a]:b.keys(this._events),j=0,k=i.length;k>j;j++)if(a=i[j],h=this._events[a]){if(this._events[a]=e=[],c||d)for(l=0,m=h.length;m>l;l++)g=h[l],(c&&c!==g.callback&&c!==g.callback._callback||d&&d!==g.context)&&e.push(g);e.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=Array.prototype.slice.call(arguments,1);if(!f(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&g(c,b),d&&g(d,arguments),this},stopListening:function(a,b,c){var d=this._listeners;if(!d)return this;var e=!b&&!c;"object"==typeof b&&(c=this),a&&((d={})[a._listenerId]=a);for(var f in d)d[f].off(b,c,this),e&&delete this._listeners[f];return this}},e=/\s+/,f=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var f in c)a[b].apply(a,[f,c[f]].concat(d));return!1}if(e.test(c)){for(var g=c.split(e),h=0,i=g.length;i>h;h++)a[b].apply(a,[g[h]].concat(d));return!1}return!0},g=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b)}},h={listenTo:"on",listenToOnce:"once"};b.each(h,function(a,c){d[c]=function(c,d,e){var f=this._listeners||(this._listeners={}),g=c._listenerId||(c._listenerId=b.uniqueId("l"));return f[g]=c,"object"==typeof d&&(e=this),c[a](d,e,this),this}});var i=function(a){a=a||{},j.call(this,a),this.validation&&k.call(this),this.initialize.call(this,a)};b.extend(i.prototype,d,{initialize:function(){}});var j=function(c){var d=b.functions(this.observables);d=b.reduce(this.observables,function(a,c,d){return b.isObject(c)&&!b.isArray(c)&&(c.read||c.write)&&a.push(d),a},d),b.each(b.omit(this.observables,d),function(d,e){this[e]=b.isArray(d)?a.isObservable(c[e])?c[e]:a.observableArray((c[e]||d).slice(0)):a.isObservable(c[e])?c[e]:a.observable(c[e]||d),this[e].subscribe(function(a){this.trigger("change:"+e,a)},this)},this),b.each(b.pick(this.observables,d),function(b,c){this[c]=a.computed(this.observables[c],this)},this)},k=function(){},l=function(){};return b.extend(l.prototype,d),a.Model=l,a.ViewModel=i,a.Model.extend=a.ViewModel.extend=c,a});
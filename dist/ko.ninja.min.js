!function(e,t){"function"==typeof define&&define.amd?define("ko.ninja.events",["underscore"],t):t(e._,e.ko)}(this,function(e,t){var n,i,o,a,s=/\s+/;return i=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var o in n)e[t].apply(e,[o,n[o]].concat(i));return!1}if(s.test(n)){for(var a=n.split(s),r=0,c=a.length;c>r;r++)e[t].apply(e,[a[r]].concat(i));return!1}return!0},a=function(e,t){var n,i=-1,o=e.length,a=t[0],s=t[1],r=t[2];switch(t.length){case 0:for(;++i<o;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<o;)(n=e[i]).callback.call(n.ctx,a);return;case 2:for(;++i<o;)(n=e[i]).callback.call(n.ctx,a,s);return;case 3:for(;++i<o;)(n=e[i]).callback.call(n.ctx,a,s,r);return;default:for(;++i<o;)(n=e[i]).callback.apply(n.ctx,t)}},n={on:function(e,t,n){if(!i(this,"on",e,[t,n])||!t)return this;this._events=this._events||(this._events={});var o=this._events[e]||(this._events[e]=[]);return o.push({callback:t,context:n,ctx:n||this}),this},once:function(t,n,o){if(!i(this,"once",t,[n,o])||!n)return this;var a=this,s=e.once(function(){a.off(t,s),n.apply(this,arguments)});return s._callback=n,this.on(t,s,o)},off:function(t,n,o){var a,s,r,c,u,f,d,l;if(!this._events||!i(this,"off",t,[n,o]))return this;if(!t&&!n&&!o)return this._events={},this;for(c=t?[t]:e.keys(this._events),u=0,f=c.length;f>u;u++)if(t=c[u],r===this._events[t]){if(this._events[t]=a=[],n||o)for(d=0,l=r.length;l>d;d++)s=r[d],(n&&n!==s.callback&&n!==s.callback._callback||o&&o!==s.context)&&a.push(s);a.length||delete this._events[t]}return this},trigger:function(e){if(!this._events)return this;var t=Array.prototype.slice.call(arguments,1);if(!i(this,"trigger",e,t))return this;var n=this._events[e],o=this._events.all;return n&&a(n,t),o&&a(o,arguments),this},stopListening:function(e,t,n){var i=this._listeners;if(!i)return this;var o=!t&&!n;"object"==typeof t&&(n=this),e&&((i={})[e._listenerId]=e);for(var a in i)i[a].off(t,n,this),o&&delete this._listeners[a];return this}},o={listenTo:"on",listenToOnce:"once"},e.each(o,function(t,i){n[i]=function(n,i,o){var a=this._listeners||(this._listeners={}),s=n._listenerId||(n._listenerId=e.uniqueId("l"));return a[s]=n,"object"==typeof i&&(o=this),n[t](i,o,this),this}}),"function"==typeof define&&define.amd?n:(t.ninjaEvents=n,void 0)}),function(e,t){"function"==typeof define&&define.amd?define("ko.ninja.extend",["underscore"],t):t(e._,e.ko)}(this,function(e,t){var n=function(t,n){var i,o,a=this;return o=t&&e.has(t,"constructor")?t.constructor:function(){return a.apply(this,arguments)},e.extend(o,a,n),i=function(){this.constructor=o},i.prototype=a.prototype,o.prototype=new i,t&&e.extend(o.prototype,t),o.__super__=a.prototype,t.name&&(o.prototype.toString=function(){return t.name}),o};return"function"==typeof define&&define.amd?n:(t.ninjaExtend=n,void 0)}),function(e,t){"function"==typeof define&&define.amd?define("ko.ninja.baseModel",["underscore","ko.ninja.events","ko.ninja.extend"],t):t(e._,e.ko.ninjaEvents,e.ko.ninjaExtend,e.ko)}(this,function(e,t,n,i){var o=function(n){n=n||{},e.isFunction(this.initialize)&&this.initialize(n),e.extend(this,t,{idAttribute:"id",invalid:function(){return localStorage?this.name?void 0:{error:!0,message:"This model has no name. Every model needs a name"}:{error:!0,message:"There is no localStorage available in this context"}},save:function(e,t){return e[this.idAttribute]?this.update(e[this.idAttribute],e,t):this.insert(e,t)}},n)};return o.extend=n,"function"==typeof define&&define.amd?o:(i.ninjaBaseModel=o,void 0)}),function(e,t){"function"==typeof define&&define.amd?define("ko.ninja.localStorageModel",["ko.ninja.baseModel"],t):t(e.ko.ninjaBaseModel,e.ko)}(this,function(e,t){var n=e.extend({find:function(e,t){var n,i=[];if(t=t||e,this.invalid())t(this.invalid(e));else{for(var o in localStorage)if(~o.indexOf(this.name+"-")){n=!0;for(var a in e)e[a]!==JSON.parse(localStorage[o])[a]&&(n=!1);n&&i.push(JSON.parse(localStorage.getItem(o)))}t(i)}},findOne:function(e,t){this.invalid()?t(this.invalid()):t(JSON.parse(localStorage[this.name+"-"+e]||"{}"))},insert:function(e,t){t=t||function(){},e[this.idAttribute]=(new Date).getTime(),this.invalid(e)?t(this.invalid(e)):(localStorage[this.name+"-"+e.id]=JSON.stringify(e),t(e))},remove:function(e,t){t=t||function(){},this.invalid()?t(this.invalid()):(delete localStorage[this.name+"-"+e],t(null))},update:function(e,t,n){n=n||function(){},this.invalid(t)?n(this.invalid(t)):(t[this.idAttribute]=e,localStorage[this.name+"-"+e]=JSON.stringify(t),n(t))}});return"function"==typeof define&&define.amd?n:(t.ninjaLocalStorageModel=n,void 0)}),function(e,t){"function"==typeof define&&define.amd?define("ko.ninja.ajax",[],t):t(e.ko)}(this,function(e){var t=function(e,t){var n,i=this;this.updating=!1,this.abort=function(){i.updating&&(i.updating=!1,i.AJAX.abort(),i.AJAX=null)},this.update=function(e,t){return i.updating?!1:(i.AJAX=null,i.AJAX=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),null===i.AJAX?!1:(i.AJAX.onreadystatechange=function(){4===i.AJAX.readyState&&(i.updating=!1,i.callback(i.AJAX.responseText,i.AJAX.status,i.AJAX.responseXML),i.AJAX=null)},i.updating=new Date,/post/i.test(t)?(n=o+"?"+i.updating.getTime(),i.AJAX.open("POST",n,!0),i.AJAX.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.AJAX.send(e)):/put/i.test(t)?(n=o+"?"+i.updating.getTime(),i.AJAX.open("PUT",n,!0),i.AJAX.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.AJAX.send(e)):(n=o+"?"+e+"&timestamp="+i.updating.getTime(),i.AJAX.open("GET",n,!0),i.AJAX.send(null)),!0))};var o=e;this.callback=t||function(){}};return"function"==typeof define&&define.amd?t:(e.ninjaAjax=t,void 0)}),function(e,t){"function"==typeof define&&define.amd?define("ko.ninja.httpModel",["ko.ninja.baseModel","ko.ninja.ajax","underscore"],t):t(e.ko.ninjaBaseModel,e.ko.ninjaAjax,e._,e.ko)}(this,function(e,t,n,i){var o=e.extend({suffix:"",urlRoot:function(){return(this.name?"/"+this.name:"")+"/"},ajax:function(e){var i;"function"==typeof $&&$.ajax?$.ajax(n.extend({success:function(t){e.complete(t)}.bind(this),error:function(t){e.complete({error:!0,message:t})}.bind(this)},e)):(i=new t(e.url,function(t){n.isFunction(e.complete)&&e.complete(JSON.parse(t))}),i.update((JSON.stringify(e.data)||"").replace(/:/g,"=").replace(/"/g,"").replace(/,/g,"&").replace(/{/g,"").replace(/}/g,""),e.method))},find:function(e,t){this.ajax({url:this.urlRoot()+this.suffix,method:"GET",data:e,complete:t||e})},findOne:function(e,t){this.ajax({url:this.urlRoot()+e+this.suffix,method:"GET",complete:t})},insert:function(e,t){t=t||function(){},this.ajax({url:this.urlRoot()+this.suffix,method:"POST",data:e,complete:t})},remove:function(e,t){t=t||function(){},this.ajax({url:this.urlRoot()+e+this.suffix,method:"DELETE",complete:t})},update:function(e,t,n){n=n||function(){},this.ajax({url:this.urlRoot()+e+this.suffix,method:"PUT",data:t,complete:n})}});return"function"==typeof define&&define.amd?o:(i.ninjaHttpModel=o,void 0)}),function(e,t){"function"==typeof define&&define.amd?define("ko.ninja.socketModel",["ko.ninja.baseModel","underscore"],t):t(e.ko.ninjaBaseModel,e._,e.ko)}(this,function(e,t,n){var i=e.extend({find:function(e,t){t||(t=e),this.socket.emit(this.messageNames.find,{data:e},t)},findOne:function(e,t){this.socket.emit(this.messageNames.findOne,{id:e},t)},insert:function(e,t){this.socket.emit(this.messageNames.insert,{data:e},t)},remove:function(e,t){this.socket.emit(this.messageNames.remove,{id:e},t)},update:function(e,t,n){this.socket.emit(this.messageNames.update,{id:e,data:t},n)},initialize:function(e){this.socket=io.connect((e.protocol||"http")+"://"+(e.hostName||"localhost")+":"+(e.port||"8080")),this.messageNames=t.extend({update:e.name+"-update",insert:e.name+"-insert",find:e.name+"-find",findOne:e.name+"-findOne",remove:e.name+"-remove"},e.messageNames||{})}});return"function"==typeof define&&define.amd?i:(n.ninjaSocketModel=i,void 0)}),function(e,t){"function"==typeof define&&define.amd?define("ko.ninja.model",["ko.ninja.extend","ko.ninja.localStorageModel","ko.ninja.httpModel","ko.ninja.socketModel"],t):t(e.ko.ninjaExtend,e.ko.ninjaLocalStorageModel,e.ko.ninjaSocketModel)}(this,function(e,t,n,i){var o=function(e){var o;switch(e.storage){case"http":o=new n(e);break;case"socket.io":o=new i(e);break;default:o=new t(e)}return o};return o.extend=e,"function"==typeof define&&define.amd?o:(ko.ninjaModel=o,void 0)}),function(e,t){"function"==typeof define&&define.amd?define("ko.ninja.validation",["knockout","underscore"],t):t(e.ko,e._)}(this,function(e,t){var n={validationTypes:{_custom:function(e,t){return t.validator.call(this,e,t)},_maxLength:function(e,t){return e.length>t.value},_minLength:function(e,t){return e.length<t.value},_length:function(e,t){return e.length!==t.value},_required:function(e){return!e||!e.length},_email:function(e){return!/[^\s@]+@[^\s@]+\.[^\s@]+/.test(e)},_number:function(e){return!(!isNaN(parseFloat(e))&&isFinite(e))}},_validate:function(e,n){var i=this[n]?this[n]():null,o=[];return t.each(e,function(e,t){if(this.validationTypes["_"+t]){var a=this.validationTypes["_"+t].call(this,i,e);a&&("string"==typeof e&&(e={message:e}),o.push({observable:n,error:e.message}))}},this),o},validateOne:function(e){var t=this._validate(this.validation[e],e);return t.length?t[0].error:void 0},validateAll:function(){var e=[];return t.each(this.validation,function(t,n){e=e.concat(this._validate(t,n))},this),e},validate:function(){var e={};return this.errors(this.validateAll()),t.each(this.errors(),function(t){e[t.observable]||(this[t.observable].error(t.error),e[t.observable]=!0)},this),this.errors().length?this.errors():null},watchValidation:function(t){this[t]&&(this[t].error=e.observable(),this[t].subscribe(function(){this[t].error(this.validateOne(t)),this.errors(this.validateAll())}.bind(this)))},watchValidations:function(){this.errors=e.observableArray(),t.each(this.validation,function(e,t){this.watchValidation(t)},this)}};return"function"==typeof define&&define.amd?n:(e.ninjaValidation=n,void 0)}),function(e,t){"function"==typeof define&&define.amd?define("ko.ninja.viewModel",["knockout","underscore","ko.ninja.events","ko.ninja.extend","ko.ninja.model","ko.ninja.validation"],t):t(e.ko,e._,e.ko.ninjaEvents,e.ko.ninjaExtend,e.ko.ninjaModel,e.ko.ninjaValidation)}(this,function(e,t,n,i,o,a){var s=function(n){var i=t.functions(this.observables);i=t.reduce(this.observables,function(e,n,i){return t.isObject(n)&&!t.isArray(n)&&(n.read||n.write)&&e.push(i),e},i),t.each(t.omit(this.observables,i),function(i,o){this[o]=t.isArray(i)?e.isObservable(n[o])?n[o]:e.observableArray((n[o]||i).slice(0)):e.isObservable(n[o])?n[o]:e.observable(n[o]||i),this[o].subscribe(function(e){this.trigger("change:"+o,e)},this)},this),t.each(t.pick(this.observables,i),function(t,n){this[n]=e.computed({read:this.observables[n],write:function(){},owner:this},this)},this)},r=function(){},c=function(){var e=this,n=function(){var n={};t.each(e.observables,function(t,i){n[i]=e[i]()}),e.model.save(n,function(){})},i=t.debounce(n,1);this.model.status||(this.model=new o(this.model)),this.autoSync!==!1&&(this.autoSync=!0),this.fetch=function(e){var n=this,i=this.autoSync;this.autoSync=!1,this.model.findOne(this[this.idAttribute||"id"](),function(o){t.each(o,function(e,t){"function"==typeof n[t]&&n[t](e)}),n.autoSync=i,t.isFunction(e)&&e()})},t.each(this.observables,function(t,n){e[n].subscribe(function(){e.autoSync&&!e.validateAll().length&&i()})})},u=function(t){t=t||{},s.call(this,t),this.watchValidations(),this.validation&&r.call(this),this.initialize.apply(this,arguments),this.model&&c.call(this,t),this.autoSync&&this.fetch(),this.el&&e.applyBindings(this,"object"==typeof this.el?this.el:document.querySelector(this.el)[0])};return t.extend(u.prototype,n,a,{initialize:function(){}}),u.extend=i,"function"==typeof define&&define.amd?u:(e.ninjaViewModel=u,void 0)}),function(e,t){"function"==typeof define&&define.amd?define("ko.ninja",["underscore","knockout","ko.ninja.viewModel","ko.ninja.model"],t):t(e._,e.ko,e.ko.ninjaViewModel,e.ko.ninjaModel)}(this,function(e,t,n,i){return t.ViewModel=n,t.Model=i,"function"==typeof define&&define.amd?t:(t.ViewModel=n,t.Model=i,void 0)});
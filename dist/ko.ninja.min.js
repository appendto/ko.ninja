define("events",["underscore"],function(t){var e,i,n,s,r=/\s+/;return i=function(t,e,i,n){if(!i)return!0;if("object"==typeof i){for(var s in i)t[e].apply(t,[s,i[s]].concat(n));return!1}if(r.test(i)){for(var o=i.split(r),a=0,c=o.length;c>a;a++)t[e].apply(t,[o[a]].concat(n));return!1}return!0},s=function(t,e){var i,n=-1,s=t.length,r=e[0],o=e[1],a=e[2];switch(e.length){case 0:for(;++n<s;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r);return;case 2:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o);return;case 3:for(;++n<s;)(i=t[n]).callback.call(i.ctx,r,o,a);return;default:for(;++n<s;)(i=t[n]).callback.apply(i.ctx,e)}},e={on:function(t,e,n){if(!i(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var s=this._events[t]||(this._events[t]=[]);return s.push({callback:e,context:n,ctx:n||this}),this},once:function(e,n,s){if(!i(this,"once",e,[n,s])||!n)return this;var r=this,o=t.once(function(){r.off(e,o),n.apply(this,arguments)});return o._callback=n,this.on(e,o,s)},off:function(e,n,s){var r,o,a,c,h,u,l,f;if(!this._events||!i(this,"off",e,[n,s]))return this;if(!e&&!n&&!s)return this._events={},this;for(c=e?[e]:t.keys(this._events),h=0,u=c.length;u>h;h++)if(e=c[h],a=this._events[e]){if(this._events[e]=r=[],n||s)for(l=0,f=a.length;f>l;l++)o=a[l],(n&&n!==o.callback&&n!==o.callback._callback||s&&s!==o.context)&&r.push(o);r.length||delete this._events[e]}return this},trigger:function(t){if(!this._events)return this;var e=Array.prototype.slice.call(arguments,1);if(!i(this,"trigger",t,e))return this;var n=this._events[t],r=this._events.all;return n&&s(n,e),r&&s(r,arguments),this},stopListening:function(t,e,i){var n=this._listeners;if(!n)return this;var s=!e&&!i;"object"==typeof e&&(i=this),t&&((n={})[t._listenerId]=t);for(var r in n)n[r].off(e,i,this),s&&delete this._listeners[r];return this}},n={listenTo:"on",listenToOnce:"once"},t.each(n,function(i,n){e[n]=function(e,n,s){var r=this._listeners||(this._listeners={}),o=e._listenerId||(e._listenerId=t.uniqueId("l"));return r[o]=e,"object"==typeof n&&(s=this),e[i](n,s,this),this}}),e}),define("extend",["underscore"],function(t){return function(e,i){var n,s,r=this;return s=e&&t.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},t.extend(s,r,i),n=function(){this.constructor=s},n.prototype=r.prototype,s.prototype=new n,e&&t.extend(s.prototype,e),s.__super__=r.prototype,e.name&&(s.prototype.toString=function(){return e.name}),s}}),define("baseModel",["underscore","events","extend"],function(t,e,i){var n=function(i){i=i||{},t.extend(this,e,{status:"processing",idAttribute:"id",setTransaction:function(t,e){this._transaction=t,this._transactionId=e},invalid:function(){return localStorage?this.name?void 0:{error:!0,message:"This model has no name. Every model needs a name"}:{error:!0,message:"There is no localStorage available in this context"}},done:function(t){var e=this;"processing"!==this.status?(this._transaction&&(this.trigger(this._transaction+"-done"),this._transactionId&&this.trigger(this._transaction+"-"+this._transactionId+"-done"),this.setTransaction()),this.status&&this.status.error?t.call(this,null,this.status):t.call(this,this.status),this.status="processing"):setTimeout(function(){e.done(t)},100)}},i)};return n.extend=i,n}),define("localStorageModel",["baseModel"],function(t){return t.extend({find:function(t){var e,i=[];if(this.setTransaction("find"),this.invalid())this.status=this.invalid(t);else{for(var n in localStorage)if(~n.indexOf(this.name+"-")){e=!0;for(var s in t)t[s]!==JSON.parse(localStorage[n])[s]&&(e=!1);e&&i.push(JSON.parse(localStorage.getItem(n)))}this.status=i}return this},findOne:function(t){return this.setTransaction("findOne",t),this.status=this.invalid()?this.invalid():JSON.parse(localStorage[this.name+"-"+t]||"{}"),this},insert:function(t){return this.setTransaction("insert"),t[this.idAttribute]=(new Date).getTime(),this.invalid(t)?this.status=this.invalid(t):(localStorage[this.name+"-"+t.id]=JSON.stringify(t),this.status=t),this},remove:function(t){return this.setTransaction("remove",t),this.invalid()?this.status=this.invalid():(delete localStorage[this.name+"-"+t],this.status=null),this},save:function(t){return t[this.idAttribute]?this.update(t[this.idAttribute],t):this.insert(t)},update:function(t,e){return this.setTransaction("update",t),this.invalid(e)?this.status=this.invalid(e):(e[this.idAttribute]=t,localStorage[this.name+"-"+t]=JSON.stringify(e),this.status=e),this}})}),define("httpModel",["baseModel"],function(t){return t.extend({urlRoot:function(){return(this.name?"/"+this.name:"")+"/"},find:function(t){return console.log("find",t),this},findOne:function(){return this}})}),define("model",["extend","localStorageModel","httpModel"],function(t,e,i){var n=function(t){var n;switch(t.storage){case"http":n=new i(t);break;default:n=new e(t)}return n};return n.extend=t,n}),define("viewModel",["knockout","underscore","events","extend","model"],function(t,e,i,n,s){var r=function(i){var n=e.functions(this.observables);n=e.reduce(this.observables,function(t,i,n){return e.isObject(i)&&!e.isArray(i)&&(i.read||i.write)&&t.push(n),t},n),e.each(e.omit(this.observables,n),function(n,s){this[s]=e.isArray(n)?t.isObservable(i[s])?i[s]:t.observableArray((i[s]||n).slice(0)):t.isObservable(i[s])?i[s]:t.observable(i[s]||n),this[s].subscribe(function(t){this.trigger("change:"+s,t)},this)},this),e.each(e.pick(this.observables,n),function(e,i){this[i]=t.computed(this.observables[i],this)},this)},o=function(){},a=function(){var t=this,i=function(){var i={};e.each(t.observables,function(e,n){i[n]=t[n]()}),t.model.save(i)},n=e.debounce(i,1);this.model.status||(this.model=new s(this.model)),this.autoSync=!0,this.fetch=function(t){var i=this,n=this.autoSync;return this.autoSync=!1,this.model.findOne(this[this.idAttribute||"id"]()).done(function(s){e.each(s,function(t,e){i[e](t)}),i.autoSync=n,e.isFunction(t)&&t()})},e.each(this.observables,function(e,i){t[i].subscribe(function(){t.autoSync&&n()})})},c=function(e){e=e||{},r.call(this,e),this.validation&&o.call(this),this.initialize.call(this,e),this.model&&a.call(this,e),this.autoSync&&this.fetch(),this.el&&t.applyBindings(this,"object"==typeof this.el?this.el:document.querySelector(this.el)[0])};return e.extend(c.prototype,i,{initialize:function(){}}),c.extend=n,c}),define("ko.ninja",["underscore","knockout","viewModel","model"],function(t,e,i,n){return e.ViewModel=i,e.Model=n,e});